#include "types.h"

#ifndef SHM_H
#define SHM_H

#define SHM_MAXNUM 16
#define SHM_NAME_LEN 16
#define SHARED_PAGE_SIZE 4096


struct shm_block {
	char name[SHM_NAME_LEN];                     //THE NAME!!!
  uint pa;                                     //PHYSICAL ADDRESS
	int ref;                                     //REFERENCE COUNT
  int shm_mutex_index;
};

struct {
	int shm_num;                                 //number of shared memory
	struct shm_block  shm_mems[SHM_MAXNUM];  //the actual shared memory
} shared_memory;            


#endif // SHM_H


/* TODO
ALLOCATE physical memeory when shm_get
copyuvm should find the pa and then imcreme the refence for the shared_memory
increase switch uvm after offset 4096
*/
/*

                             .::::..:::....
                           .:""":::..::.  :::..
                       ...::::::.     :.::: ':::
                   ..:::::.. ..:::.  .  '::: :".::.
                 .::::" . '": ' .::.. ": ::" :.. '::
               ..::...  ':..: .:::::::.:. :::.: ':::":.
            .:::::'""":..:::::::"''  ''"::..::::'::".:::.
         .::::..   ::""::... .            '"::::"' . ":.:.
        .::'''"":: ""  ":..  .                "      .'":.:.
        ::::...   .::..:.. .                            "":.:.
       ::::::'"...::'"..::.. . .                         . :.".
     .:""  ':. ::""'  ':::..  .                         .  ':.".
    ::::   ..  ::  :::"':::.. .     .                  .  . '::':
    :::...::::" ' .':' '::::.. .      .             .     .  ::::
    .:::'""   ' .:::::.':I:::.  .         .      .      .  . :"::.
   .""'  :::"   ::"'    :II::'     ...         .        ... .:''::
  ::.   .::"  .:"''':...:I::"  :II:::IHI:..          .:::I:'':  ':
  :::::. :.  .:..:.  ..:::::'IH:::::II:::IHHI.    .HI.:IHI:'':. .:
 :"'   '    ..::"'    ":::"IHI:IHI""..""::IHHI.'  IHIH"''':.::: ":.
:.::""    '::''  .   .::::'IHHHHI:":H:':::..:I:.  HI':H:':..::'":':
:::  ..    ::. '::":.::::.I:. ::::....:..:I.IH:.  '::.".:.:I":. ".":.
::''::::"'  "   :::" :::...  . ':::' ''  .:IIH:.   ::.' :":" :.:   ':.
::'   '   .:"' .::"::::... .      .   ....::IHI.   ::"  . '  :. ..   :.
:::::"':::"'  .:I.: "::.. .             ...::II:   :I:'      : .  "::.':
"::". :"''  . :I :" :I::.. .              ..::II.  ':"       :. :: ':: ::
 :::.. .:' :' :I:'  ':I::.. .            . ..:II"   ::       :I.'::.:: :'
 ':"''":I:.  .:I:.:: :II::... .           ::""I:.   :.      .:I: "::"'.:
  :..:"'::::::::'':'.":II:::.. .        .::'...I:...::.     .:I:  '..::"
  "::' .."".::"::.'  .:II:::... . .   ...::."I:::::I". .   ...:"   :'
   ':..::  .:"::::   .:II:..     .   .... "I:..II:"' '.. ..:.:"   .:
     """"::::.":::II::II::. .         .  .  .  ""    .:. .:.:I'...:"
          ':: .::I::HII::::.. .     .       ..  .  .  :..:"':"::""'
           ::.:I:I:::HI::::::. .    ....::::II::.::I::: '  ::
           IIHHI: "::IHI::::.'   .  '":""""""""::""'':'   .:"
           :IHHIH.::::IIHI::.         '":::........::'    .:
           ':IHIH:':::.:IIH::. .         '':::::::::"'  ..:'
            8::IIH: . ':."::I:.       ...::"''     ''' .::"
           .:..:IIH. . ':.':::I:. .  ...            . .::"
       ..:HI. ..IIHI  .  '..'::::II::.    .       .  .::"
 .:::::IIHHI .  II:H: ..   '.'...::::::.         ..:::"
IHI.:H:" IH:.   ::IIH. ..      ''"::::::::......::":.
HH:' ".:IHI .   ':IIHI: .'.        '""::::"""''"  .::
IH:..::IIH'..    :IIIHI. . '.    .   .    .     .'.::
I:HI:".IHI.::.   .:IIIHI. ..  '.    .  .'     ..'. :":.
I::'.:I::::::. . .:IIIIHI. .. . '.   ..     ..'  .:I:.":.
 I:IIH.::':::.. ...:IIIIHH.  ..    '.:.. ..''   .::IHI: ":.
.:II:::. ..::.. . .:IIIIIHH.  :.. ..::''...::..:".:HHIII. ":.
III:...:...::. . . ::IIIIHHH  ......:. ..  '::::.::IHHHHH:. :.
II:::::. ..:::. . ..::IIIHIH ........: .. .. '.:.:''IHHHHHI :'
 :::::. . .:::..  ...::IIHHI :..... .. .... ... '...::IHHH :'
II::::.:.::::.::.  .. :II:H: :....  .:  ':.. ... '...::HHI I(.
:::::::.:::::..:..  ..:II:HI ':..  .::.  '... ...   ..:IH: H::.:.
:::.....:::::..:.:. . .:::IH. ':. ..::..  '... '...   '.HI "H:...:.
::... ..::::::.::.... ::..IIH. ':...:8...  '.    ....:'..H  "H:..:.:.
''  ''..:::I::..:.:...::.:IIIH. ':.::.::.... .::::''.:.'':H. "H:. .:  .
   . . ..::I:::.:::.. .::::IIIH  :.:: :'''' .:: ::   ':..:IH. :I ...:.
    . . ..II:::::::..  .:::IIIH  :.::  .:::'.:' :::  .:'.IIHH :H :..: .
     . . .II::.:.:::.. .:::IIHH  :.::..:::' ::  ..:. :.::HIHI :I.:: :: .
      . . :II:. .::. ..  ":IIHH  :.:'''":'  :',  . '..'""I:HI H' ':. ::
       .   I::. .::.  .   :IIIH  :.::   '''':'  ..   :. :I.II H. .:. ":.
      .    :::. .I::. .   ::IIH: ::::..  . .:':.':' ..' .I:I: H ..:. .::.
           :::...::I:..   .::IHI ,:::...  ....'  '..'. .:I::: I. ::' . ::
            I::.''::I...  .::IIH .::.:.. . ..  ..   :.   :.:: I..:  . .
            :I:.. :::H. .  "::IH .:'"::. .  .. ..   ::...:'.: I..:   .
            "II.. ":::H. .  .::H. :.:.::. ..::.:'  .:''':::I'.I .: :.
             II:.  :::I:.  . ::HI I.::..''' :'::.  :.   "::IS:I:II::.
             :I:   .:::I:. ..::HI I.:: '   . .:::' .'    ':I :III:::. .
              :I.   ..::I:...::IH I:.. .  .  .    . .. .  ::.III:::. .
              ':'  .....:I::.:::H I::' . .    . .   ...  .: IIII:I:..
                    . ...:I:.:::H I:' .  .   .      ..   :: III:::. .
                     . ...:I:..:H I: .    . ..       .  ..: III..::.
                      . ...:I:.:H.::      . ..     . . ..:: II:'':'
                        . ..:I..::.:     . .      ... .. :: I:" .
                         . ..::.:.:        .     ......  :'
                           ...::'          .   ... .
                            ':':'          .   ..
                                          .   .




*/

